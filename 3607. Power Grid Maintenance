#!/usr/bin/python
"""You can see the description of the task using the code specified in the title on leetcode.
This program has O(n) complexity by time and O(n) by space.

For me, all problems involving constructing individual data structures are considered hard.
You also need to consider creating an ordered set here.
I learned what a DSU is, sat down with Google, and wrote an implementation of the problem. 
It seems Google deserves more credit than I do, but it was useful.
"""

class DSU:
    def __init__(self, n):
        self.parent = list(range(n))
        self.size = [1] * n

    def find(self, i):
        if self.parent[i] == i:
            return i
        self.parent[i] = self.find(self.parent[i])
        return self.parent[i]

    def union(self, i, j):
        root_i = self.find(i)
        root_j = self.find(j)

        if root_i != root_j:
            if self.size[root_i] < self.size[root_j]:
                self.parent[root_i] = root_j
                self.size[root_j] += self.size[root_i]
            else:
                self.parent[root_j] = root_i
                self.size[root_i] += self.size[root_j]
            return True
        return False


class Solution:
    def processQueries(self, c: int, connections: List[List[int]], queries: List[List[int]]) -> List[int]:
        dsu = DSU(c + 1)
        for u, v in connections:
            dsu.union(u, v)

        grid_nodes = defaultdict(list)
        for i in range(1, c + 1):
            root = dsu.find(i)
            heapq.heappush(grid_nodes[root], i)

        offline = set()
        result = []

        for q in queries:
            t, x = q
            if t == 1:
                if x not in offline:
                    result.append(x)
                else:
                    root = dsu.find(x)
                    while grid_nodes[root] and grid_nodes[root][0] in offline:
                        heapq.heappop(grid_nodes[root])
                    result.append(grid_nodes[root][0] if grid_nodes[root] else -1)
            else:
                offline.add(x)

        return result
